.row(ui-view="edit_alumno")


.row
	.col-xs-12.col-md-12
		.well.with-header.with-footer
			.header.bordered-yellow Alumnos 
				a.btn.btn-info.shiny(ui-sref="panel.alumnos.nuevo" uib-tooltip="Ingresa datos de un nuevo alumno") Crear alumno
			
			.form-group
				label Grupo en el cual matricular
				div
					span(uib-tooltip="Debe seleccionar un grupo" tooltip-placement="right")
						ui-select(ng-model="dato.grupo" on-select="onGrupoSelect($item, $model)" theme="select2" style="min-width: 200px;")
							ui-select-match(placeholder="Grupo a matricular" allow-clear="true") {{$select.selected.nombre}}
							ui-select-choices(repeat="grupo in grupos | filter: $select.search")
								div(ng-bind-html="grupo.nombre | highlight: $select.search")


			table.table.table-striped
				thead
					tr
						th(style="max-width: 10px") No
						th 
							a(href="" ng-click="dato.sortType = 'no_matricula'; dato.sortReverse = !dato.sortReverse")
								| Matr√≠cula 
								span.fa.fa-caret-down(ng-show="dato.sortType == 'no_matricula' && !dato.sortReverse")
								span.fa.fa-caret-up(ng-show="dato.sortType == 'no_matricula' && dato.sortReverse")
						th 
							a(href="" ng-click="dato.sortType = 'apellidos'; dato.sortReverse = !dato.sortReverse")
								| Apellidos 
								span.fa.fa-caret-down(ng-show="dato.sortType == 'apellidos' && !dato.sortReverse")
								span.fa.fa-caret-up(ng-show="dato.sortType == 'apellidos' && dato.sortReverse")
						th 
							a(href="" ng-click="dato.sortType = 'nombres'; dato.sortReverse = !dato.sortReverse")
								| Nombres 
								span.fa.fa-caret-down(ng-show="dato.sortType == 'nombres' && !dato.sortReverse")
								span.fa.fa-caret-up(ng-show="dato.sortType == 'nombres' && dato.sortReverse")
						th(style="max-width: 20px; padding: 0px 0px 8px;") 
							a(href="" ng-click="dato.sortType = 'sexo'; dato.sortReverse = !dato.sortReverse")
								i(style="font-weight: bold;").fa.fa-venus-mars 
								span.fa.fa-caret-down(ng-show="dato.sortType == 'sexo' && !dato.sortReverse")
								span.fa.fa-caret-up(ng-show="dato.sortType == 'sexo' && dato.sortReverse")
						th(style="min-width: 120px; text-align: center;") 
							a(href="" ng-click="dato.sortType = 'estado'; dato.sortReverse = !dato.sortReverse")
								| Estado 
								span.fa.fa-caret-down(ng-show="dato.sortType == 'estado' && !dato.sortReverse")
								span.fa.fa-caret-up(ng-show="dato.sortType == 'estado' && dato.sortReverse")
						th
							a(href="" ng-click="dato.sortType = 'fecha_retiro'; dato.sortReverse = !dato.sortReverse")
								| Retirado 
								span.fa.fa-caret-down(ng-show="dato.sortType == 'fecha_retiro' && !dato.sortReverse")
								span.fa.fa-caret-up(ng-show="dato.sortType == 'fecha_retiro' && dato.sortReverse")
						th
							a(href="" ng-click="dato.sortType = 'fecha_matricula'; dato.sortReverse = !dato.sortReverse")
								| Matriculado 
								span.fa.fa-caret-down(ng-show="dato.sortType == 'fecha_matricula' && !dato.sortReverse")
								span.fa.fa-caret-up(ng-show="dato.sortType == 'fecha_matricula' && dato.sortReverse")
				tbody.filasestrechas
					tr(ng-repeat="alumno in alumnos_all | orderBy:dato.sortType:dato.sortReverse" ng-class="{'filagris': alumno.grupo_id!=dato.grupo.id, 'filawarning': alumno.estado=='RETI', 'filadanger': alumno.estado=='ASIS' }")
						td {{ $index+1 }}
						td 
							| {{ alumno.no_matricula }}

						td 
							div( uib-popover-template="views+'alumnos/popoverAlumnoInfo.tpl.html'" 
								popover-title="{{alumno.nombres + ' ' + alumno.apellidos}}" 
								popover-trigger="mouseenter" popover-popup-delay="500") 

								img(ng-src="{{perfilPath + alumno.foto_nombre}}" style="width: 20px; height: 20px; margin-top: -3px;")
								| {{ alumno.apellidos }}
						td 
							| {{ alumno.nombres }}

						td {{ alumno.sexo }}
						td
							span(ng-show="alumno.grupo_id==dato.grupo.id || alumno.estado=='RETI' ")
								
								span.btn-group(style="margin-top: -2px; padding-bottom: 2px;")
									label.btn.btn-info.btn-xs(ng-model="alumno.estado" uib-btn-radio="'MATR'" ng-click="reMatricularUno(alumno)") Matr
									label.btn.btn-info.btn-xs(ng-model="alumno.estado" uib-btn-radio="'ASIS'" ng-click="setAsistente(alumno)") Asis
									label.btn.btn-info.btn-xs(ng-model="alumno.estado" uib-btn-radio="'RETI'" ng-click="retirar(alumno)") Reti

							.btn-group(ng-show="alumno.grupo_id!=dato.grupo.id " style="margin-top: -2px; padding-bottom: 2px;")
								label.btn.btn-success.shiny.btn-xs(ng-click="setNewAsistente(alumno)") Asis
								label.btn.btn-success.shiny.btn-xs(ng-click="matricularUno(alumno)") Matric
								label.btn.btn-success.shiny.btn-xs(ng-click="matricularMas(alumno)") ...

						td 
							input(ng-model="alumno.fecha_retiro" type="date" ng-show="alumno.estado=='RETI'" 
								ng-change="cambiarFechaRetiro(alumno)" ng-model-options="{ updateOn: 'default blur', debounce: {'default': 1000, 'blur': 0} }")
						td 
							input(ng-model="alumno.fecha_matricula" type="date" ng-change="cambiarFechaMatricula(alumno)" ng-model-options="{ updateOn: 'default blur', debounce: {'default': 1000, 'blur': 0} }")

				tfoot
					tr
						td 
						td 
						td 
						td 
						td 
						td 
						td 
						td 



